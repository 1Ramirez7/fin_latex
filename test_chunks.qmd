---
title: "Untitled"
format: html
---

yml code 

      - name: Install Pandoc
        uses: pandoc/actions/setup@v1


```{python}
# Create formulas_tag.qmd with tags moved outside formulas
import re

with open('formulas.qmd', 'r', encoding='utf-8') as f: 
    content = f.read()

# Move formula tags outside so they appear in Word/PowerPoint
modified_content = re.sub(r'\$\$([^$]+)\\tag\{([^}]+)\}\$\$', r'$$\1$$ (\2)', content)

with open('formulas_tag.qmd', 'w', encoding='utf-8') as f:
    f.write(modified_content)

print("Created 'formulas_tag.qmd' with tags preserved outside formulas.")
```


```{python}
# Word chunk: Convert to Word doc
import subprocess
import shutil
import os

subprocess.run(['quarto', 'pandoc', 'formulas_tag.qmd', '-o', 'formulas.docx'], check=True)

os.makedirs('_site', exist_ok=True)
shutil.copy('formulas.docx', '_site/formulas.docx')
print("Word document 'formulas.docx' created and copied to _site/")
```


```{python}
# PowerPoint chunk: Convert to PowerPoint
import subprocess
import shutil
import os

subprocess.run(['quarto', 'pandoc', 'formulas_tag.qmd', '-o', 'formulas.pptx'], check=True)

os.makedirs('_site', exist_ok=True)
shutil.copy('formulas.pptx', '_site/formulas.pptx')
print("PowerPoint 'formulas.pptx' created and copied to _site/")
```


testing 

```{python}
# Convert to PDF, simple as pdf keeps tag
import subprocess

# Render to PDF using Quarto
subprocess.run(['quarto', 'render', 'formulas.qmd', '--to', 'pdf'])

print("PDF document 'formulas.pdf' created.")
```





